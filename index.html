<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="utf-8" />
		<title>Гостей всего</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<style>
			html,
			body {
				margin: 0;
				height: 100%;
				background: #1c1c1c;
				color: #e7eefc;
				font-family: Inter, system-ui, Arial;
			}
			.wrap {
				display: flex;
				align-items: center;
				justify-content: center;
				height: 100%;
				flex-direction: column;
				gap: 24px;
			}
			.label {
				font-size: 3vw;
				opacity: 0.8;
			}
			.value {
				font-size: clamp(120px, 35vw, 520px);
				font-weight: 800;
				line-height: 1;
				letter-spacing: 2px;
				text-align: center;
			}
			@media (max-width: 800px) {
				.label {
					font-size: 6vw;
				}
				.value {
					font-size: 42vw;
				}
			}
		</style>
	</head>
	<body>
		<div class="wrap">
			<div class="label">Гостей всего</div>
			<div id="num" class="value">—</div>
		</div>
		<script>
			const API = "/api/guests"
			const REFRESH_MS = 5 * 60 * 1000 // 5 минут
			async function load() {
				try {
					const r = await fetch(API, { cache: "no-store" })
					const j = await r.json()
					if (r.ok && typeof j.value === "number") {
						document.getElementById("num").textContent = j.value
					} else {
						document.getElementById("num").textContent = "—"
					}
				} catch (e) {
					document.getElementById("num").textContent = "—"
				}
			}
			load()
			setInterval(load, REFRESH_MS)
			document.addEventListener("visibilitychange", () => {
				if (!document.hidden) load()
			})
		</script>
	</body>
</html>
